services:
  upload-assistant:
    container_name: upload-assistant
    image: ghcr.io/audionut/upload-assistant:v6.3.1-webui
    restart: unless-stopped
    environment:
      ENABLE_WEB_UI: "true"
      UA_WEBUI_HOST: "0.0.0.0"
      UA_WEBUI_PORT: "5000"
      UA_BROWSE_ROOTS: "/data/torrents,/Upload-Assistant/tmp"
      UA_WEBUI_CORS_ORIGINS: ${UA_WEBUI_CORS_ORIGINS}
    volumes:
      - /volume1/data:/data
      - /volume2/docker/qbittorrent/volumes/config/data/BT_backup/:/torrent_storage_dir
      - /volume2/docker/upload-assistant/volumes/tmp/:/Upload-Assistant/tmp
      - /volume2/docker/upload-assistant/volumes/data/config.py:/Upload-Assistant/data/config.py
    entrypoint: /bin/bash
    command: -c "source /venv/bin/activate && python /Upload-Assistant/web_ui/server.py & tail -f /dev/null"
    networks:
      - prod_net
    labels:
      - "traefik.enable=true"
      - "traefik.http.routers.upload-assistant.rule=Host(`upload.${DOMAIN}`)"
      - "traefik.http.routers.upload-assistant.entrypoints=web"
      - "traefik.http.services.upload-assistant.loadbalancer.server.port=5000"

networks:
  prod_net:
    external: true
